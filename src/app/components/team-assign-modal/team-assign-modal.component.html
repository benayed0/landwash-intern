<div class="modal-overlay" *ngIf="isOpen" (click)="onClose()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2 class="modal-title">Assigner une équipe</h2>
      <button class="close-btn" (click)="onClose()">×</button>
    </div>

    <div class="modal-body" *ngIf="booking">
      <div class="booking-info">
        <div class="info-row">
          <span class="info-label">Type de service:</span>
          <span class="info-value">
            {{ getVehicleTypeLabel(booking.type) }}
            <span *ngIf="booking.type === 'salon' && booking.salonsSeats" class="salon-seats">
              ({{ booking.salonsSeats }} sièges)
            </span>
          </span>
        </div>
        <div class="info-row">
          <span class="info-label">Date:</span>
          <span class="info-value">{{ formatDate(booking.date) }}</span>
        </div>
        <div class="info-row">
          <span class="info-label">Adresse:</span>
          <span class="info-value">{{ booking.address || 'Non spécifiée' }}</span>
        </div>
      </div>

      <div class="team-selection">
        <label for="team-select" class="select-label">Sélectionner une équipe:</label>

        <div class="loading" *ngIf="loadingTeams">
          Chargement des équipes...
        </div>

        <select
          id="team-select"
          class="team-select"
          [(ngModel)]="selectedTeamId"
          *ngIf="!loadingTeams"
          [disabled]="teams.length === 0">
          <option value="">-- Choisir une équipe --</option>
          <option *ngFor="let team of teams" [value]="team._id">
            {{ team.name }} ({{ team.members?.length || 0 }} membres)
          </option>
        </select>

        <div class="no-teams-message" *ngIf="!loadingTeams && teams.length === 0">
          Aucune équipe disponible. Veuillez créer une équipe d'abord.
        </div>
      </div>
    </div>

    <div class="modal-footer">
      <button class="btn btn-cancel" (click)="onClose()">Annuler</button>
      <button
        class="btn btn-confirm"
        (click)="confirm()"
        [disabled]="!selectedTeamId || loadingTeams">
        Confirmer et assigner
      </button>
    </div>
  </div>
</div>
