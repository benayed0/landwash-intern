<div class="modal-overlay" *ngIf="isOpen" (click)="onCancel()">
  <div class="modal-container" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>üè¢ Cr√©er une nouvelle √©quipe</h3>
    </div>

    <div class="modal-body">
      <form (ngSubmit)="onSubmit()" #teamForm="ngForm">
        <!-- Name Field -->
        <div class="form-group">
          <label for="teamName">Nom de l'√©quipe *</label>
          <input
            type="text"
            id="teamName"
            [(ngModel)]="newTeam.name"
            name="teamName"
            class="form-input"
            [class.error]="nameError"
            placeholder="Ex: √âquipe Nord"
            required
            [disabled]="isSubmitting"
          />
          <span class="error-message" *ngIf="nameError">{{ nameError }}</span>
        </div>

        <!-- Members Selection -->
        <div class="form-group">
          <label>Membres de l'√©quipe</label>
          <div class="members-list" *ngIf="availablePersonals.length > 0">
            <div
              class="member-item"
              *ngFor="let personal of availablePersonals"
              [class.selected]="isPersonalSelected(personal._id!)"
              (click)="onPersonalToggle(personal._id!)"
            >
              <div class="member-checkbox">
                <span *ngIf="isPersonalSelected(personal._id!)">‚úì</span>
              </div>
              <div class="member-avatar">
                {{ personal.name.charAt(0).toUpperCase() }}
              </div>
              <div class="member-info">
                <div class="member-name">{{ personal.name }}</div>
                <div class="member-details">{{ personal.email }}</div>
              </div>
            </div>
          </div>
          <div class="empty-state" *ngIf="availablePersonals.length === 0">
            <p>Aucun personnel disponible</p>
          </div>
        </div>

        <!-- Location Selection -->
        <div class="form-group">
          <label>Localisation de l'√©quipe</label>
          <div class="location-info" *ngIf="newTeam.coordinates">
            <p>üìç Latitude: {{ newTeam.coordinates[1].toFixed(6) }}</p>
            <p>üìç Longitude: {{ newTeam.coordinates[0].toFixed(6) }}</p>
          </div>
          <div class="map-container">
            <div id="map" class="map" (click)="onModalOpen()"></div>
            <p class="map-hint">
              üëÜ Cliquez sur la carte pour d√©finir la localisation de l'√©quipe
            </p>
          </div>
        </div>

        <!-- Radius Selection -->
        <div class="form-group">
          <label for="radius">Rayon d'action (kilom√®tres)</label>
          <div class="radius-container">
            <input
              type="range"
              id="radius"
              [(ngModel)]="newTeam.radius"
              name="radius"
              class="radius-slider"
              min="1"
              max="100"
              step="1"
              (input)="onRadiusChange()"
              [disabled]="isSubmitting"
            />
            <div class="radius-value">{{ newTeam.radius }}km</div>
          </div>
          <div class="radius-labels">
            <span>1km</span>
            <span>100km</span>
          </div>
        </div>
      </form>
    </div>

    <div class="modal-actions">
      <button
        type="button"
        class="btn-cancel"
        (click)="onCancel()"
        [disabled]="isSubmitting"
      >
        Annuler
      </button>
      <button
        type="button"
        class="btn-confirm"
        (click)="onSubmit()"
        [disabled]="isSubmitting"
      >
        <span *ngIf="!isSubmitting">‚úì Cr√©er l'√©quipe</span>
        <span *ngIf="isSubmitting">‚è≥ Cr√©ation...</span>
      </button>
    </div>
  </div>
</div>
