<div class="profile-container">
  <div class="content">
    <div class="profile-header">
      <div class="profile-title"></div>
    </div>

    <div class="profile-card" *ngIf="currentUser">
      <!-- Avatar Section -->
      <div style="display: flex; justify-content: end">
        <button class="edit-btn" (click)="toggleEdit()" *ngIf="!isEditing">
          ‚úèÔ∏è Modifier
        </button>
      </div>
      <div class="avatar-section">
        <div class="avatar">
          {{ (currentUser.name || currentUser.email || "?")[0].toUpperCase() }}
        </div>
        <div
          class="status-badge"
          [class.active]="currentUser.status === 'active'"
        >
          {{ getStatusLabel(currentUser.status) }}
        </div>
      </div>

      <!-- Profile Information -->
      <div class="profile-info">
        <!-- Name Field -->
        <div class="info-group">
          <label>Nom</label>
          <input
            *ngIf="isEditing"
            type="text"
            [(ngModel)]="editedUser.name"
            class="edit-input"
            placeholder="Votre nom"
          />
          <div *ngIf="!isEditing" class="info-value">
            {{ currentUser.name || "Non renseign√©" }}
          </div>
        </div>

        <!-- Email Field -->
        <div class="info-group">
          <label>Email</label>
          <input
            *ngIf="isEditing"
            type="email"
            [(ngModel)]="editedUser.email"
            class="edit-input"
            placeholder="Votre email"
            [disabled]="true"
          />
          <div *ngIf="!isEditing" class="info-value">
            {{ currentUser.email }}
          </div>
        </div>

        <!-- Phone Field -->
        <div class="info-group">
          <label>T√©l√©phone</label>
          <input
            *ngIf="isEditing"
            type="tel"
            [(ngModel)]="editedUser.phone"
            class="edit-input"
            placeholder="Votre t√©l√©phone"
          />
          <div *ngIf="!isEditing" class="info-value">
            {{ currentUser.phone || "Non renseign√©" }}
          </div>
        </div>

        <!-- Role Field (Read-only) -->
        <div class="info-group">
          <label>R√¥le</label>
          <div class="info-value role-badge" [class]="currentUser.role">
            {{ getRoleLabel(currentUser.role) }}
          </div>
        </div>

        <!-- Team Info (for workers) -->
        <!-- <div class="info-group" *ngIf="currentUser.role === 'worker' && (currentUser as any).teamId">
          <label>√âquipe</label>
          <div class="info-value">
            {{ (currentUser as any).teamId.name || 'Non assign√©' }}
          </div>
        </div> -->

        <!-- Created Date -->
        <div class="info-group">
          <label>Membre depuis</label>
          <div class="info-value">
            {{ currentUser.createdAt | date : "dd/MM/yyyy" }}
          </div>
        </div>

        <!-- Notification Toggle (Mobile Only) -->
        <div class="info-group" *ngIf="isMobile && !isEditing">
          <label>Notifications push</label>
          <div class="notification-toggle">
            <button
              class="toggle-btn"
              [class.active]="notificationsEnabled"
              [disabled]="isLoadingNotificationStatus"
              (click)="toggleNotifications()"
            >
              <span
                class="toggle-slider"
                [class.active]="notificationsEnabled"
              ></span>
            </button>
            <span class="toggle-label">
              {{ notificationsEnabled ? "Activ√©es" : "D√©sactiv√©es" }}
            </span>
            <span class="loading-spinner" *ngIf="isLoadingNotificationStatus"
              >‚è≥</span
            >
          </div>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="profile-actions">
        <div class="edit-actions" *ngIf="isEditing">
          <button class="btn btn-save" (click)="saveProfile()">
            üíæ Enregistrer
          </button>
          <button class="btn btn-cancel" (click)="toggleEdit()">
            ‚ùå Annuler
          </button>
        </div>

        <button class="btn btn-logout" (click)="logout()" *ngIf="!isEditing">
          üö™ D√©connexion
        </button>
      </div>
    </div>

    <!-- Loading State -->
    <div class="loading" *ngIf="!currentUser">Chargement du profil...</div>
  </div>
</div>
