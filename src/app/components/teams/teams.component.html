<div class="teams-container">
  <app-navbar></app-navbar>

  <div class="page-header">
    <h1>Équipes et Personnel</h1>
  </div>

  <div class="content">
    <app-loading-spinner
      *ngIf="loading"
      [size]="'medium'"
      [message]="'Chargement des équipes...'"
      [color]="'primary'">
    </app-loading-spinner>

    <div *ngIf="!loading">
      <div class="section-title">Équipes</div>

      <div *ngIf="teams.length === 0" class="empty-state">
        <p>Aucune équipe disponible</p>
      </div>

      <div class="team-card" *ngFor="let team of teams">
        <div class="team-header">
          <div class="team-name">{{ team.name }}</div>
          <div class="team-badge">{{ team.members.length || 0 }} membres</div>
        </div>

        <div
          class="member-list"
          *ngIf="team.members && team.members.length > 0"
        >
          <div class="member-item" *ngFor="let memberId of team.members">
            <div
              class="member-avatar"
              *ngIf="getMemberDetails(memberId) as member"
            >
              {{ getInitials(member.name) }}
            </div>
            <div
              class="member-info"
              *ngIf="getMemberDetails(memberId) as member"
            >
              <div class="member-name">{{ member.name }}</div>
              <div class="member-contact">
                {{ member.phone }} • {{ member.email }}
              </div>
            </div>
            <div
              class="member-role"
              *ngIf="getMemberDetails(memberId) as member"
            >
              {{ member.role }}
            </div>
          </div>
        </div>
      </div>

      <div class="personals-section">
        <div
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
          "
        >
          <div class="section-title">Tout le Personnel</div>
          <button class="add-btn" (click)="showAddPersonalModal = true">
            Créer un Compte
          </button>
        </div>
        <div *ngIf="personals.length === 0" class="empty-state">
          <p>Aucun personnel disponible</p>
        </div>

        <div class="personal-card" *ngFor="let personal of personals">
          <div class="personal-avatar">
            {{ getInitials(personal.name) }}
          </div>
          <div class="personal-info">
            <div class="personal-name">{{ personal.name }}</div>
            <div class="personal-details">
              {{ personal.email }}<br />
              {{ personal.phone }}
            </div>
          </div>
          <div class="personal-role">
            {{ personal.role === "admin" ? "Administrateur" : "Employé" }}
          </div>
        </div>
      </div>
    </div>
  </div>
  <app-add-personal-modal
    (close)="showAddPersonalModal = false"
    [isOpen]="showAddPersonalModal"
    (confirmAdd)="createdAccount($event)"
  ></app-add-personal-modal>
  <app-bottom-bar [activeTab]="'teams'"></app-bottom-bar>
</div>
